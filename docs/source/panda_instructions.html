

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using the Franka Panda &mdash; perls2 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Redis Help" href="redis.html" />
    <link rel="prev" title="Set up workstation for Franka Panda" href="panda_ws_setup.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> perls2
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="panda_setup.html">Franka Panda Setup</a></li>
</ul>
<p class="caption"><span class="caption-text">Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="environments.html">Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="worlds.html">World</a></li>
<li class="toctree-l1"><a class="reference internal" href="robot_interfaces.html">RobotInterfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="controller_eqns.html">Controllers</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../simple_reach.html">Simple Reach Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="load_objects.html">Examples: Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="switch_sim_real.html">Switching between Real and Sim Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="project_template.html">Project Template</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../env.html">Environment (Env)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../world.html">World</a></li>
<li class="toctree-l1"><a class="reference internal" href="../robot_interface.html">Robot Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controller.html">Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../object_interface.html">Object Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../camera_interface.html">Camera Interface</a></li>
</ul>
<p class="caption"><span class="caption-text">Real Robot Control</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="panda_setup.html">Franka Panda Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="panda_nuc_setup.html">Set up NUC (Control PC) for the Franka Panda</a></li>
<li class="toctree-l1"><a class="reference internal" href="panda_ws_setup.html">Set up workstation for Franka Panda</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using the Franka Panda</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="#important-notes-about-using-franka-panda-arms">Important notes about using Franka Panda Arms.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#instructions-for-using-the-franka-panda-arms">Instructions for using the Franka Panda Arms</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="redis.html">Redis Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="sawyer_instructions.html">Using the Rethink Sawyer Arm</a></li>
<li class="toctree-l1"><a class="reference internal" href="demos.html">Controller Demos</a></li>
</ul>
<p class="caption"><span class="caption-text">Real Cameras</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="real_cameras.html">perls2 with Real Cameras</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">perls2</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Using the Franka Panda</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/source/panda_instructions.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="using-the-franka-panda">
<h1>Using the Franka Panda<a class="headerlink" href="#using-the-franka-panda" title="Permalink to this headline">¶</a></h1>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Using the Franka Panda arm with torque control requires a consistent control loop frequency for sending torque commands to the arm. In order to acheive this, a separate machine with an RT Kernel is connected to the Franka’s FCI. This machine, typically an Intel NUC, is dedicated to running only the processes necessary for torque control. A separate machine, referred to as the workstation, is used to host the perls2 environment for the experiment.</p>
<p>perls2 provides scripts and wrappers for libfranka to perform torque control on the NUC. A Redis server is used for interprocess communication for perls2 and the libfranka driver, as well as for communication between the NUC and the workstation. See the README in perls2/redis_interfaces for more information.</p>
</div>
<div class="section" id="important-notes-about-using-franka-panda-arms">
<h2>Important notes about using Franka Panda Arms.<a class="headerlink" href="#important-notes-about-using-franka-panda-arms" title="Permalink to this headline">¶</a></h2>
<ol>
<li><p><strong>Have the E-STOP in hand.</strong></p>
<p>Performing torque control with robots can pose a risk to both the user and the robot. It is important to take precautions and keep the E-STOP in hand when performing robot experiments.</p>
</li>
<li><p><strong>Flush redis before starting the driver.</strong></p>
<p>The redis-server contains many flags used to operate the robot arm. It’s best to regularly flush the redis server with the FLUSHALL redis-cli command before starting
the driver. This prevents any stale commands from triggering the PandaCtrlInterface to start running.</p>
</li>
<li><p><strong>Use redis-cli</strong></p>
<p>It’s a good idea to get familiar with some basic commands in redis-cli. This allows you to get a human-readable print out of the robot’s state and commands being sent.</p>
</li>
<li><p><strong>Confirm resets on the driver.</strong></p>
<p>When the driver receives a reset command, it requires the user confirm by pressing Enter before it resets the robot. This is because the joint space controller performing the reset does not perform collision checking, and makes sure you have a hand on the E-STOP.</p>
</li>
</ol>
</div>
<div class="section" id="instructions-for-using-the-franka-panda-arms">
<h2>Instructions for using the Franka Panda Arms<a class="headerlink" href="#instructions-for-using-the-franka-panda-arms" title="Permalink to this headline">¶</a></h2>
<p>After following instructions to setup the NUC and workstation, the Franka Arms may be operated entirely from the workstation.</p>
<ol>
<li><p>Turn on the Franka Master Control box. The base lights of the Franka should be Yellow indicating the joints are locked.</p></li>
<li><p>Open a browser and go the Franka Desk App (usually <code class="docutils literal notranslate"><span class="pre">https://&lt;fci-ip&gt;</span></code> or <a class="reference external" href="https://172.16.0.2">https://172.16.0.2</a>). Unlock the Franka Arm. You should hear a series of clicks.</p></li>
<li><p>Confirm that the Franka is unlocked by verifying the base lights are White (IDLE) mode. You should be able to move the robot by pinching the buttons above the base.</p></li>
<li><p>Pull the user-stop so that the lights at the base of the Franka are blue.</p></li>
<li><p>Open a terminal and ssh into the control pc (NUC).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ssh <span class="o">[</span>control-pc-username<span class="o">]</span>@<span class="o">[</span>control-pc-ip<span class="o">]</span>
</pre></div>
</div>
</li>
<li><p>Move to the perls2 repo directory, and run the <code class="docutils literal notranslate"><span class="pre">start_panda_control.sh</span></code> with the path to the <code class="docutils literal notranslate"><span class="pre">perls2_local_control_pc</span></code> as an argument. If you don’t supply an path, the script will use the folder found in the <code class="docutils literal notranslate"><span class="pre">local</span></code> directory in the perls2 repo.</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/perls2
./scripts/start_panda_control.sh ~/perls2_local_control_pc
</pre></div>
</div>
<ol>
<li><p>Open another terminal and source your perls2 environment. You can now run your perls2 script.</p></li>
<li><p>Run your perls2 script. For example, run the gravity-compensation demo:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span> ~/p2env/bin/activate
<span class="nb">cd</span> ~/perls2<span class="p">;</span> 
python demos/run_gc_demo.py --world<span class="o">=</span>Real
</pre></div>
</div>
</li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="redis.html" class="btn btn-neutral float-right" title="Redis Help" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="panda_ws_setup.html" class="btn btn-neutral float-left" title="Set up workstation for Franka Panda" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, StanfordVL

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>